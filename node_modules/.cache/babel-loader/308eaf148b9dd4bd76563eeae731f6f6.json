{"ast":null,"code":"import axios from 'axios';\nimport storage from './storage';\n\nconst getAuthHeader = token => `Bearer ${token}`;\n\nexport const setupApi = () => {\n  axios.interceptors.response.use(response => response, async error => {\n    const {\n      response\n    } = error;\n\n    if (!response) {\n      return Promise.reject(error);\n    }\n\n    if (response.config.url === 'public-api/login') {\n      storage.removeToken();\n      return Promise.reject(error);\n    }\n\n    if (response.status === 401) {\n      storage.removeToken();\n      window.location = '/';\n    }\n\n    return Promise.reject(error);\n  });\n  axios.interceptors.request.use(request => {\n    const token = storage.getToken();\n    request.headers.Authorization = getAuthHeader(token);\n    return request;\n  });\n  axios.defaults.baseURL = process.env.REACT_APP_ENDPOINT;\n  axios.defaults.timeout = 20000;\n};","map":{"version":3,"sources":["/home/gonza/src/meraki-bo/src/services/http.js"],"names":["axios","storage","getAuthHeader","token","setupApi","interceptors","response","use","error","Promise","reject","config","url","removeToken","status","window","location","request","getToken","headers","Authorization","defaults","baseURL","process","env","REACT_APP_ENDPOINT","timeout"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,MAAMC,aAAa,GAAGC,KAAK,IAAK,UAASA,KAAM,EAA/C;;AAEA,OAAO,MAAMC,QAAQ,GAAG,MAAM;AAC5BJ,EAAAA,KAAK,CAACK,YAAN,CAAmBC,QAAnB,CAA4BC,GAA5B,CAAgCD,QAAQ,IAAIA,QAA5C,EAAsD,MAAME,KAAN,IAAe;AACnE,UAAM;AAAEF,MAAAA;AAAF,QAAeE,KAArB;;AACA,QAAI,CAACF,QAAL,EAAe;AACb,aAAOG,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD;;AACD,QAAIF,QAAQ,CAACK,MAAT,CAAgBC,GAAhB,KAAwB,kBAA5B,EAAgD;AAC9CX,MAAAA,OAAO,CAACY,WAAR;AACA,aAAOJ,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD;;AACD,QAAIF,QAAQ,CAACQ,MAAT,KAAoB,GAAxB,EAA6B;AAC3Bb,MAAAA,OAAO,CAACY,WAAR;AACAE,MAAAA,MAAM,CAACC,QAAP,GAAkB,GAAlB;AACD;;AACD,WAAOP,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACD,GAdD;AAeAR,EAAAA,KAAK,CAACK,YAAN,CAAmBY,OAAnB,CAA2BV,GAA3B,CAA+BU,OAAO,IAAI;AACxC,UAAMd,KAAK,GAAGF,OAAO,CAACiB,QAAR,EAAd;AACAD,IAAAA,OAAO,CAACE,OAAR,CAAgBC,aAAhB,GAAgClB,aAAa,CAACC,KAAD,CAA7C;AACA,WAAOc,OAAP;AACD,GAJD;AAKAjB,EAAAA,KAAK,CAACqB,QAAN,CAAeC,OAAf,GAAyBC,OAAO,CAACC,GAAR,CAAYC,kBAArC;AACAzB,EAAAA,KAAK,CAACqB,QAAN,CAAeK,OAAf,GAAyB,KAAzB;AACD,CAvBM","sourcesContent":["import axios from 'axios';\nimport storage from './storage';\n\nconst getAuthHeader = token => `Bearer ${token}`;\n\nexport const setupApi = () => {\n  axios.interceptors.response.use(response => response, async error => {\n    const { response } = error;\n    if (!response) {\n      return Promise.reject(error);\n    }\n    if (response.config.url === 'public-api/login') {\n      storage.removeToken();\n      return Promise.reject(error);\n    }\n    if (response.status === 401) {\n      storage.removeToken();\n      window.location = '/';\n    }\n    return Promise.reject(error);\n  });\n  axios.interceptors.request.use(request => {\n    const token = storage.getToken();\n    request.headers.Authorization = getAuthHeader(token);\n    return request;\n  });\n  axios.defaults.baseURL = process.env.REACT_APP_ENDPOINT;\n  axios.defaults.timeout = 20000;\n};\n"]},"metadata":{},"sourceType":"module"}